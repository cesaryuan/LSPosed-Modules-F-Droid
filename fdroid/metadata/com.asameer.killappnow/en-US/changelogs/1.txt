Improved logic to detect foreground app